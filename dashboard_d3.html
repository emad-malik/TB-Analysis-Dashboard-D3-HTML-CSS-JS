<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TB Analysis Dashboard</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <header>
        <h1>TB Analysis</h1>
    </header>

    <!-- Stats Row -->
    <div class="stats-row">
        <div class="stat-card" id="stat1">Total Incidence</div>
        <div class="stat-card" id="stat2">Average Rate (per 100k)</div>
        <div class="stat-card" id="stat3">Mortality Rate (per 100k)</div>
        <div class="stat-card" id="stat4">Countries Analyzed</div>
    </div>


    <!-- ELEMENTS FOR TIMELINE VISUALIZATION -->
    <!-- Timeline Visualization -->
    <div id="timeline" class="timeline">
        <div id="timeline-container"></div>
    </div>
    
    <!-- tooltip div -->
    <div class="timeline_tooltip" id="timeline_tooltip"></div>


    <!-- Row of two visualizations: Tree and Map -->
    <div class="visualization-row">
        <div id="tree-container" class="visualization half"></div>
        <div id="map-container" class="visualization half"></div>
    </div>

    <!-- Row of two visualizations: FD and Sunburst -->
    <div class="visualization-row">
        <div id="fd-container" class="visualization half"></div>
        <div id="sunburst-container" class="visualization half"></div>
    </div>

    <script>
        d3.csv("data/preprocessed_data_tb.csv").then(function(data) {
        const totalIncidence = d3.sum(data, d => d.e_inc_num);
        const avgRate = d3.mean(data, d => d.e_inc_100k);
        const mortality_rate = d3.mean(data, d => d.e_mort_exc_tbhiv_100k);
        const countries = new Set(data.map(d => d.country)).size;

        d3.select("#stat1").text(`Total Incidence: ${totalIncidence}`);
        d3.select("#stat2").text(`Avg Rate: ${avgRate.toFixed(2)} per 100k`);
        d3.select("#stat3").text(`Mortality Rate: ${mortality_rate}`);
        d3.select("#stat4").text(`Countries: ${countries}`);
});

    </script>

    <!-- Import scripts for visualizations -->
    <script src="js/timeline.js"></script>
    <script src="js/tree.js"></script>
    <script src="js/mapchart.js"></script>
    <script src="js/fd.js"></script>
    <script src="js/sunburst.js"></script>
</body>
</html>
